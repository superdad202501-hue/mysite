<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>御城新天地晨晨 - 鬼畜弹幕</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- 配置Tailwind自定义颜色 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF0066',
            secondary: '#00FFFF',
            accent: '#FFFF00',
            neon: '#9D00FF',
            flash: '#FF3300'
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow-glow {
        text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 20px currentColor;
      }
      .text-shadow-heavy {
        text-shadow: 0 0 8px #000, 0 0 12px currentColor;
      }
      .rotate-random {
        transform: rotate(var(--rotation, 0deg));
      }
      .scale-pulse {
        animation: scalePulse 0.5s infinite alternate;
      }
      .flash {
        animation: flash 0.3s infinite alternate;
      }
    }
  </style>
  
  <style>
    body {
      overflow: hidden;
      margin: 0;
      height: 100vh;
      background: linear-gradient(45deg, #000000, #220033, #000A33);
      background-size: 400% 400%;
      animation: bgShift 15s ease infinite;
    }
    
    /* 背景动态效果 */
    @keyframes bgShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .bg-grid {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
      background-size: 50px 50px;
      z-index: 1;
      animation: gridMove 20s linear infinite;
    }
    
    @keyframes gridMove {
      from { background-position: 0 0; }
      to { background-position: 50px 50px; }
    }
    
    /* 弹幕样式 */
    .danmaku {
      position: absolute;
      white-space: nowrap;
      z-index: 10;
      pointer-events: none;
      will-change: transform, opacity;
      font-weight: bold;
      transition: all 0.1s;
    }
    
    /* 弹幕动画 */
    .danmaku-left { animation: moveRight linear forwards; }
    .danmaku-right { animation: moveLeft linear forwards; }
    .danmaku-top { animation: moveDown linear forwards; }
    .danmaku-bottom { animation: moveUp linear forwards; }
    
    @keyframes moveRight {
      from { transform: translateX(-100%) rotate(var(--rotation, 0deg)); }
      to { transform: translateX(calc(100vw + 100%)) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes moveLeft {
      from { transform: translateX(calc(100vw + 100%)) rotate(var(--rotation, 0deg)); }
      to { transform: translateX(-100%) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes moveDown {
      from { transform: translateY(-100%) rotate(var(--rotation, 0deg)); }
      to { transform: translateY(calc(100vh + 100%)) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes moveUp {
      from { transform: translateY(calc(100vh + 100%)) rotate(var(--rotation, 0deg)); }
      to { transform: translateY(-100%) rotate(var(--rotation, 0deg)); }
    }
    
    /* 特效动画 */
    @keyframes scalePulse {
      from { transform: scale(1) rotate(var(--rotation, 0deg)); }
      to { transform: scale(1.3) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes flash {
      from { opacity: 0.7; }
      to { opacity: 1; }
    }
    
    /* 中心标题动画 */
    .center-title {
      animation: float 3s ease-in-out infinite, glow 2s infinite alternate;
    }
    
    @keyframes float {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -52%) scale(1.05); }
    }
    
    @keyframes glow {
      from { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor; }
      to { text-shadow: 0 0 15px currentColor, 0 0 30px currentColor, 0 0 40px currentColor; }
    }
    
    /* 按钮样式 */
    .control-btn {
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .control-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px currentColor;
    }
  </style>
</head>
<body>
  <!-- 背景网格 -->
  <div class="bg-grid"></div>
  
  <!-- 音频元素 (默认隐藏) -->
  <audio id="bgMusic" loop>
    <!-- 使用高节奏电子音乐，可替换为其他有强烈节拍的音乐 -->
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3" type="audio/mpeg">
  </audio>
  
  <!-- 中心标题 -->
  <div class="fixed top-1/2 left-1/2 center-title z-20 text-center">
    <div class="text-[clamp(1.8rem,6vw,4rem)] font-black text-white text-shadow-glow mb-2">
      平江买房
    </div>
    <div class="text-[clamp(2.5rem,10vw,6rem)] font-extrabold text-primary text-shadow-glow mb-2">
      御城新天地
    </div>
    <div class="text-[clamp(2.2rem,8vw,5rem)] font-black text-accent text-shadow-glow">
      找晨晨！！
    </div>
  </div>
  
  <!-- 控制按钮 -->
  <div class="fixed bottom-8 left-1/2 transform -translate-x-1/2 z-30 flex flex-wrap justify-center gap-4">
    <button id="startBtn" class="control-btn bg-primary text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center">
      <i class="fa fa-play mr-2"></i> 开始狂欢
    </button>
    <button id="addDanmaku" class="control-btn bg-secondary text-black font-bold py-3 px-8 rounded-full shadow-lg flex items-center">
      <i class="fa fa-bolt mr-2"></i> 狂轰滥炸
    </button>
    <button id="clearDanmaku" class="control-btn bg-dark text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center">
      <i class="fa fa-trash mr-2"></i> 一键清空
    </button>
  </div>

  <script>
    // 音频上下文与分析器 (用于节奏检测)
    let audioContext;
    let analyser;
    let dataArray;
    let isPlaying = false;
    
    // 扩展弹幕核心内容 (更多变体和鬼畜风格)
    const coreTexts = [
      "平江买房找御城新天地晨晨！",
      "御城新天地晨晨！平江买房！",
      "晨晨！晨晨！御城新天地！",
      "平江买房！就找晨晨！在御城新天地！",
      "御城新天地！晨晨最靠谱！",
      "晨晨帮你买好房！就在御城新天地！",
      "平江！御城新天地！晨晨！买房！",
      "找晨晨！买好房！御城新天地！",
      "御城新天地晨晨，平江买房不迷路！",
      "晨晨！御城新天地！冲鸭！",
      "平江买房首选！御城新天地晨晨！",
      "晨晨在御城新天地等你！",
      "御城新天地！晨晨！平江买房必看！",
      "买房子！找晨晨！御城新天地！",
      "晨晨最棒！御城新天地最牛！",
      "平江！御城新天地！晨晨！yyds！",
      "不买后悔！御城新天地晨晨！",
      "晨晨带您选好房！御城新天地！",
      "御城新天地晨晨，买房so easy！",
      "平江买房，御城新天地晨晨是王道！"
    ];
    
    // 增强版强调词 (更具冲击力)
    const emphasis = [
      "爆了！", "必买！", "疯抢！", "冲！", "绝了！", 
      "炸裂！", "无敌！", "强推！", "巨划算！", "抢疯了！",
      "错过拍大腿！", "不看亏了！", "闭眼入！", "顶级！", "猛！"
    ];
    
    // 特效前缀/后缀
    const effects = ["【", "】", "🔥", "💥", "🚀", "✨", "‼️", "❗", "‼️"];
    
    // 高对比度颜色 (增强视觉冲击)
    const colors = [
      "#FF0066", "#00FFFF", "#FFFF00", "#FF3300", "#9D00FF", 
      "#00FF66", "#FF9900", "#FF00FF", "#0066FF", "#FF6666"
    ];
    
    // 初始化音频分析器
    function initAudio() {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      analyser = audioContext.createAnalyser();
      analyser.fftSize = 256;
      const bufferLength = analyser.frequencyBinCount;
      dataArray = new Uint8Array(bufferLength);
      
      const audioElement = document.getElementById('bgMusic');
      const source = audioContext.createMediaElementSource(audioElement);
      source.connect(analyser);
      analyser.connect(audioContext.destination);
    }
    
    // 创建弹幕 (增强版)
    function createDanmaku(isBeat = false) {
      const danmaku = document.createElement('div');
      danmaku.classList.add('danmaku');
      
      // 随机内容组合 (增强多样性)
      const baseText = coreTexts[Math.floor(Math.random() * coreTexts.length)];
      const useEffect = Math.random() > 0.3; // 70%概率添加特效符号
      const useEmphasis = Math.random() > 0.4; // 60%概率添加强调词
      
      let text = baseText;
      if (useEmphasis) {
        const emp = emphasis[Math.floor(Math.random() * emphasis.length)];
        text = Math.random() > 0.5 
          ? `${emp}${text}` 
          : `${text}${emp}`;
      }
      if (useEffect) {
        const eff1 = effects[Math.floor(Math.random() * effects.length)];
        const eff2 = effects[Math.floor(Math.random() * effects.length)];
        text = `${eff1}${text}${eff2}`;
      }
      
      danmaku.textContent = text;
      
      // 随机样式 (增强视觉冲击)
      const fontSize = isBeat 
        ? Math.floor(Math.random() * 20) + 24 // 节奏点更大的弹幕
        : Math.floor(Math.random() * 18) + 14; // 普通大小
      danmaku.style.fontSize = `${fontSize}px`;
      danmaku.style.color = colors[Math.floor(Math.random() * colors.length)];
      
      // 随机旋转角度 (-15到15度)
      const rotation = (Math.random() * 30 - 15);
      danmaku.style.setProperty('--rotation', `${rotation}deg`);
      danmaku.classList.add('rotate-random');
      
      // 节奏点特效
      if (isBeat) {
        if (Math.random() > 0.5) danmaku.classList.add('scale-pulse');
        if (Math.random() > 0.7) danmaku.classList.add('flash');
      }
      
      // 随机方向 (增加上下双向)
      const direction = Math.random();
      let duration;
      
      if (direction < 0.4) { // 40% 左到右
        danmaku.classList.add('danmaku-left');
        const top = Math.floor(Math.random() * 80) + 10;
        danmaku.style.top = `${top}%`;
        duration = isBeat ? Math.floor(Math.random() * 5) + 4 : Math.floor(Math.random() * 8) + 6;
      } else if (direction < 0.8) { // 40% 右到左
        danmaku.classList.add('danmaku-right');
        const top = Math.floor(Math.random() * 80) + 10;
        danmaku.style.top = `${top}%`;
        duration = isBeat ? Math.floor(Math.random() * 5) + 4 : Math.floor(Math.random() * 8) + 6;
      } else if (direction < 0.9) { // 10% 上到下
        danmaku.classList.add('danmaku-top');
        const left = Math.floor(Math.random() * 70) + 10;
        danmaku.style.left = `${left}%`;
        duration = isBeat ? Math.floor(Math.random() * 4) + 3 : Math.floor(Math.random() * 6) + 4;
      } else { // 10% 下到上
        danmaku.classList.add('danmaku-bottom');
        const left = Math.floor(Math.random() * 70) + 10;
        danmaku.style.left = `${left}%`;
        duration = isBeat ? Math.floor(Math.random() * 4) + 3 : Math.floor(Math.random() * 6) + 4;
      }
      
      danmaku.style.animationDuration = `${duration}s`;
      document.body.appendChild(danmaku);
      
      // 动画结束后移除
      setTimeout(() => {
        if (danmaku.parentNode) danmaku.remove();
      }, duration * 1000);
    }
    
    // 检测音乐节奏并生成弹幕
    function checkBeatAndCreateDanmaku() {
      if (!isPlaying) return;
      
      analyser.getByteFrequencyData(dataArray);
      let sum = 0;
      // 分析低频部分 (节奏通常在低频)
      for (let i = 0; i < 32; i++) {
        sum += dataArray[i];
      }
      const average = sum / 32;
      
      // 当音量超过阈值，判定为节奏点
      if (average > 80) { // 阈值可根据音乐调整
        // 节奏点生成1-3个强化弹幕
        const count = Math.floor(Math.random() * 3) + 1;
        for (let i = 0; i < count; i++) {
          setTimeout(() => createDanmaku(true), i * 100);
        }
      }
      
      requestAnimationFrame(checkBeatAndCreateDanmaku);
    }
    
    // 自动生成普通弹幕
    let autoDanmakuInterval;
    function startAutoDanmaku() {
      autoDanmakuInterval = setInterval(() => {
        if (isPlaying) createDanmaku();
      }, 200); // 普通弹幕生成间隔
    }
    
    // 事件监听
    document.getElementById('startBtn').addEventListener('click', () => {
      const btn = document.getElementById('startBtn');
      if (!isPlaying) {
        // 开始播放
        if (!audioContext) initAudio();
        document.getElementById('bgMusic').play();
        isPlaying = true;
        btn.innerHTML = '<i class="fa fa-pause mr-2"></i> 暂停';
        btn.classList.remove('bg-primary');
        btn.classList.add('bg-flash');
        checkBeatAndCreateDanmaku();
        startAutoDanmaku();
      } else {
        // 暂停播放
        document.getElementById('bgMusic').pause();
        isPlaying = false;
        btn.innerHTML = '<i class="fa fa-play mr-2"></i> 继续';
        btn.classList.remove('bg-flash');
        btn.classList.add('bg-primary');
        clearInterval(autoDanmakuInterval);
      }
    });
    
    // 狂轰滥炸按钮 (一次生成多个弹幕)
    document.getElementById('addDanmaku').addEventListener('click', () => {
      const count = Math.floor(Math.random() * 10) + 8; // 8-17个弹幕
      for (let i = 0; i < count; i++) {
        setTimeout(() => createDanmaku(Math.random() > 0.3), i * 50);
      }
    });
    
    // 清空弹幕
    document.getElementById('clearDanmaku').addEventListener('click', () => {
      document.querySelectorAll('.danmaku').forEach(d => d.remove());
    });
  </script>
</body>
</html>