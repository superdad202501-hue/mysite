<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ - é¬¼ç•œå¼¹å¹•</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- é…ç½®Tailwindè‡ªå®šä¹‰é¢œè‰² -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF0066',
            secondary: '#00FFFF',
            accent: '#FFFF00',
            neon: '#9D00FF',
            flash: '#FF3300'
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow-glow {
        text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 20px currentColor;
      }
      .text-shadow-heavy {
        text-shadow: 0 0 8px #000, 0 0 12px currentColor;
      }
      .rotate-random {
        transform: rotate(var(--rotation, 0deg));
      }
      .scale-pulse {
        animation: scalePulse 0.5s infinite alternate;
      }
      .flash {
        animation: flash 0.3s infinite alternate;
      }
    }
  </style>
  
  <style>
    body {
      overflow: hidden;
      margin: 0;
      height: 100vh;
      background: linear-gradient(45deg, #000000, #220033, #000A33);
      background-size: 400% 400%;
      animation: bgShift 15s ease infinite;
    }
    
    /* èƒŒæ™¯åŠ¨æ€æ•ˆæœ */
    @keyframes bgShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .bg-grid {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
      background-size: 50px 50px;
      z-index: 1;
      animation: gridMove 20s linear infinite;
    }
    
    @keyframes gridMove {
      from { background-position: 0 0; }
      to { background-position: 50px 50px; }
    }
    
    /* å¼¹å¹•æ ·å¼ */
    .danmaku {
      position: absolute;
      white-space: nowrap;
      z-index: 10;
      pointer-events: none;
      will-change: transform, opacity;
      font-weight: bold;
      transition: all 0.1s;
    }
    
    /* å¼¹å¹•åŠ¨ç”» */
    .danmaku-left { animation: moveRight linear forwards; }
    .danmaku-right { animation: moveLeft linear forwards; }
    .danmaku-top { animation: moveDown linear forwards; }
    .danmaku-bottom { animation: moveUp linear forwards; }
    
    @keyframes moveRight {
      from { transform: translateX(-100%) rotate(var(--rotation, 0deg)); }
      to { transform: translateX(calc(100vw + 100%)) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes moveLeft {
      from { transform: translateX(calc(100vw + 100%)) rotate(var(--rotation, 0deg)); }
      to { transform: translateX(-100%) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes moveDown {
      from { transform: translateY(-100%) rotate(var(--rotation, 0deg)); }
      to { transform: translateY(calc(100vh + 100%)) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes moveUp {
      from { transform: translateY(calc(100vh + 100%)) rotate(var(--rotation, 0deg)); }
      to { transform: translateY(-100%) rotate(var(--rotation, 0deg)); }
    }
    
    /* ç‰¹æ•ˆåŠ¨ç”» */
    @keyframes scalePulse {
      from { transform: scale(1) rotate(var(--rotation, 0deg)); }
      to { transform: scale(1.3) rotate(var(--rotation, 0deg)); }
    }
    
    @keyframes flash {
      from { opacity: 0.7; }
      to { opacity: 1; }
    }
    
    /* ä¸­å¿ƒæ ‡é¢˜åŠ¨ç”» */
    .center-title {
      animation: float 3s ease-in-out infinite, glow 2s infinite alternate;
    }
    
    @keyframes float {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -52%) scale(1.05); }
    }
    
    @keyframes glow {
      from { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor; }
      to { text-shadow: 0 0 15px currentColor, 0 0 30px currentColor, 0 0 40px currentColor; }
    }
    
    /* æŒ‰é’®æ ·å¼ */
    .control-btn {
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .control-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px currentColor;
    }
  </style>
</head>
<body>
  <!-- èƒŒæ™¯ç½‘æ ¼ -->
  <div class="bg-grid"></div>
  
  <!-- éŸ³é¢‘å…ƒç´  (é»˜è®¤éšè—) -->
  <audio id="bgMusic" loop>
    <!-- ä½¿ç”¨é«˜èŠ‚å¥ç”µå­éŸ³ä¹ï¼Œå¯æ›¿æ¢ä¸ºå…¶ä»–æœ‰å¼ºçƒˆèŠ‚æ‹çš„éŸ³ä¹ -->
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3" type="audio/mpeg">
  </audio>
  
  <!-- ä¸­å¿ƒæ ‡é¢˜ -->
  <div class="fixed top-1/2 left-1/2 center-title z-20 text-center">
    <div class="text-[clamp(1.8rem,6vw,4rem)] font-black text-white text-shadow-glow mb-2">
      å¹³æ±Ÿä¹°æˆ¿
    </div>
    <div class="text-[clamp(2.5rem,10vw,6rem)] font-extrabold text-primary text-shadow-glow mb-2">
      å¾¡åŸæ–°å¤©åœ°
    </div>
    <div class="text-[clamp(2.2rem,8vw,5rem)] font-black text-accent text-shadow-glow">
      æ‰¾æ™¨æ™¨ï¼ï¼
    </div>
  </div>
  
  <!-- æ§åˆ¶æŒ‰é’® -->
  <div class="fixed bottom-8 left-1/2 transform -translate-x-1/2 z-30 flex flex-wrap justify-center gap-4">
    <button id="startBtn" class="control-btn bg-primary text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center">
      <i class="fa fa-play mr-2"></i> å¼€å§‹ç‹‚æ¬¢
    </button>
    <button id="addDanmaku" class="control-btn bg-secondary text-black font-bold py-3 px-8 rounded-full shadow-lg flex items-center">
      <i class="fa fa-bolt mr-2"></i> ç‹‚è½°æ»¥ç‚¸
    </button>
    <button id="clearDanmaku" class="control-btn bg-dark text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center">
      <i class="fa fa-trash mr-2"></i> ä¸€é”®æ¸…ç©º
    </button>
  </div>

  <script>
    // éŸ³é¢‘ä¸Šä¸‹æ–‡ä¸åˆ†æå™¨ (ç”¨äºèŠ‚å¥æ£€æµ‹)
    let audioContext;
    let analyser;
    let dataArray;
    let isPlaying = false;
    
    // æ‰©å±•å¼¹å¹•æ ¸å¿ƒå†…å®¹ (æ›´å¤šå˜ä½“å’Œé¬¼ç•œé£æ ¼)
    const coreTexts = [
      "å¹³æ±Ÿä¹°æˆ¿æ‰¾å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ï¼",
      "å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ï¼å¹³æ±Ÿä¹°æˆ¿ï¼",
      "æ™¨æ™¨ï¼æ™¨æ™¨ï¼å¾¡åŸæ–°å¤©åœ°ï¼",
      "å¹³æ±Ÿä¹°æˆ¿ï¼å°±æ‰¾æ™¨æ™¨ï¼åœ¨å¾¡åŸæ–°å¤©åœ°ï¼",
      "å¾¡åŸæ–°å¤©åœ°ï¼æ™¨æ™¨æœ€é è°±ï¼",
      "æ™¨æ™¨å¸®ä½ ä¹°å¥½æˆ¿ï¼å°±åœ¨å¾¡åŸæ–°å¤©åœ°ï¼",
      "å¹³æ±Ÿï¼å¾¡åŸæ–°å¤©åœ°ï¼æ™¨æ™¨ï¼ä¹°æˆ¿ï¼",
      "æ‰¾æ™¨æ™¨ï¼ä¹°å¥½æˆ¿ï¼å¾¡åŸæ–°å¤©åœ°ï¼",
      "å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ï¼Œå¹³æ±Ÿä¹°æˆ¿ä¸è¿·è·¯ï¼",
      "æ™¨æ™¨ï¼å¾¡åŸæ–°å¤©åœ°ï¼å†²é¸­ï¼",
      "å¹³æ±Ÿä¹°æˆ¿é¦–é€‰ï¼å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ï¼",
      "æ™¨æ™¨åœ¨å¾¡åŸæ–°å¤©åœ°ç­‰ä½ ï¼",
      "å¾¡åŸæ–°å¤©åœ°ï¼æ™¨æ™¨ï¼å¹³æ±Ÿä¹°æˆ¿å¿…çœ‹ï¼",
      "ä¹°æˆ¿å­ï¼æ‰¾æ™¨æ™¨ï¼å¾¡åŸæ–°å¤©åœ°ï¼",
      "æ™¨æ™¨æœ€æ£’ï¼å¾¡åŸæ–°å¤©åœ°æœ€ç‰›ï¼",
      "å¹³æ±Ÿï¼å¾¡åŸæ–°å¤©åœ°ï¼æ™¨æ™¨ï¼yydsï¼",
      "ä¸ä¹°åæ‚”ï¼å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ï¼",
      "æ™¨æ™¨å¸¦æ‚¨é€‰å¥½æˆ¿ï¼å¾¡åŸæ–°å¤©åœ°ï¼",
      "å¾¡åŸæ–°å¤©åœ°æ™¨æ™¨ï¼Œä¹°æˆ¿so easyï¼",
      "å¹³æ±Ÿä¹°æˆ¿ï¼Œå¾¡åŸæ–°å¤©åœ°æ™¨æ™¨æ˜¯ç‹é“ï¼"
    ];
    
    // å¢å¼ºç‰ˆå¼ºè°ƒè¯ (æ›´å…·å†²å‡»åŠ›)
    const emphasis = [
      "çˆ†äº†ï¼", "å¿…ä¹°ï¼", "ç–¯æŠ¢ï¼", "å†²ï¼", "ç»äº†ï¼", 
      "ç‚¸è£‚ï¼", "æ— æ•Œï¼", "å¼ºæ¨ï¼", "å·¨åˆ’ç®—ï¼", "æŠ¢ç–¯äº†ï¼",
      "é”™è¿‡æ‹å¤§è…¿ï¼", "ä¸çœ‹äºäº†ï¼", "é—­çœ¼å…¥ï¼", "é¡¶çº§ï¼", "çŒ›ï¼"
    ];
    
    // ç‰¹æ•ˆå‰ç¼€/åç¼€
    const effects = ["ã€", "ã€‘", "ğŸ”¥", "ğŸ’¥", "ğŸš€", "âœ¨", "â€¼ï¸", "â—", "â€¼ï¸"];
    
    // é«˜å¯¹æ¯”åº¦é¢œè‰² (å¢å¼ºè§†è§‰å†²å‡»)
    const colors = [
      "#FF0066", "#00FFFF", "#FFFF00", "#FF3300", "#9D00FF", 
      "#00FF66", "#FF9900", "#FF00FF", "#0066FF", "#FF6666"
    ];
    
    // åˆå§‹åŒ–éŸ³é¢‘åˆ†æå™¨
    function initAudio() {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      analyser = audioContext.createAnalyser();
      analyser.fftSize = 256;
      const bufferLength = analyser.frequencyBinCount;
      dataArray = new Uint8Array(bufferLength);
      
      const audioElement = document.getElementById('bgMusic');
      const source = audioContext.createMediaElementSource(audioElement);
      source.connect(analyser);
      analyser.connect(audioContext.destination);
    }
    
    // åˆ›å»ºå¼¹å¹• (å¢å¼ºç‰ˆ)
    function createDanmaku(isBeat = false) {
      const danmaku = document.createElement('div');
      danmaku.classList.add('danmaku');
      
      // éšæœºå†…å®¹ç»„åˆ (å¢å¼ºå¤šæ ·æ€§)
      const baseText = coreTexts[Math.floor(Math.random() * coreTexts.length)];
      const useEffect = Math.random() > 0.3; // 70%æ¦‚ç‡æ·»åŠ ç‰¹æ•ˆç¬¦å·
      const useEmphasis = Math.random() > 0.4; // 60%æ¦‚ç‡æ·»åŠ å¼ºè°ƒè¯
      
      let text = baseText;
      if (useEmphasis) {
        const emp = emphasis[Math.floor(Math.random() * emphasis.length)];
        text = Math.random() > 0.5 
          ? `${emp}${text}` 
          : `${text}${emp}`;
      }
      if (useEffect) {
        const eff1 = effects[Math.floor(Math.random() * effects.length)];
        const eff2 = effects[Math.floor(Math.random() * effects.length)];
        text = `${eff1}${text}${eff2}`;
      }
      
      danmaku.textContent = text;
      
      // éšæœºæ ·å¼ (å¢å¼ºè§†è§‰å†²å‡»)
      const fontSize = isBeat 
        ? Math.floor(Math.random() * 20) + 24 // èŠ‚å¥ç‚¹æ›´å¤§çš„å¼¹å¹•
        : Math.floor(Math.random() * 18) + 14; // æ™®é€šå¤§å°
      danmaku.style.fontSize = `${fontSize}px`;
      danmaku.style.color = colors[Math.floor(Math.random() * colors.length)];
      
      // éšæœºæ—‹è½¬è§’åº¦ (-15åˆ°15åº¦)
      const rotation = (Math.random() * 30 - 15);
      danmaku.style.setProperty('--rotation', `${rotation}deg`);
      danmaku.classList.add('rotate-random');
      
      // èŠ‚å¥ç‚¹ç‰¹æ•ˆ
      if (isBeat) {
        if (Math.random() > 0.5) danmaku.classList.add('scale-pulse');
        if (Math.random() > 0.7) danmaku.classList.add('flash');
      }
      
      // éšæœºæ–¹å‘ (å¢åŠ ä¸Šä¸‹åŒå‘)
      const direction = Math.random();
      let duration;
      
      if (direction < 0.4) { // 40% å·¦åˆ°å³
        danmaku.classList.add('danmaku-left');
        const top = Math.floor(Math.random() * 80) + 10;
        danmaku.style.top = `${top}%`;
        duration = isBeat ? Math.floor(Math.random() * 5) + 4 : Math.floor(Math.random() * 8) + 6;
      } else if (direction < 0.8) { // 40% å³åˆ°å·¦
        danmaku.classList.add('danmaku-right');
        const top = Math.floor(Math.random() * 80) + 10;
        danmaku.style.top = `${top}%`;
        duration = isBeat ? Math.floor(Math.random() * 5) + 4 : Math.floor(Math.random() * 8) + 6;
      } else if (direction < 0.9) { // 10% ä¸Šåˆ°ä¸‹
        danmaku.classList.add('danmaku-top');
        const left = Math.floor(Math.random() * 70) + 10;
        danmaku.style.left = `${left}%`;
        duration = isBeat ? Math.floor(Math.random() * 4) + 3 : Math.floor(Math.random() * 6) + 4;
      } else { // 10% ä¸‹åˆ°ä¸Š
        danmaku.classList.add('danmaku-bottom');
        const left = Math.floor(Math.random() * 70) + 10;
        danmaku.style.left = `${left}%`;
        duration = isBeat ? Math.floor(Math.random() * 4) + 3 : Math.floor(Math.random() * 6) + 4;
      }
      
      danmaku.style.animationDuration = `${duration}s`;
      document.body.appendChild(danmaku);
      
      // åŠ¨ç”»ç»“æŸåç§»é™¤
      setTimeout(() => {
        if (danmaku.parentNode) danmaku.remove();
      }, duration * 1000);
    }
    
    // æ£€æµ‹éŸ³ä¹èŠ‚å¥å¹¶ç”Ÿæˆå¼¹å¹•
    function checkBeatAndCreateDanmaku() {
      if (!isPlaying) return;
      
      analyser.getByteFrequencyData(dataArray);
      let sum = 0;
      // åˆ†æä½é¢‘éƒ¨åˆ† (èŠ‚å¥é€šå¸¸åœ¨ä½é¢‘)
      for (let i = 0; i < 32; i++) {
        sum += dataArray[i];
      }
      const average = sum / 32;
      
      // å½“éŸ³é‡è¶…è¿‡é˜ˆå€¼ï¼Œåˆ¤å®šä¸ºèŠ‚å¥ç‚¹
      if (average > 80) { // é˜ˆå€¼å¯æ ¹æ®éŸ³ä¹è°ƒæ•´
        // èŠ‚å¥ç‚¹ç”Ÿæˆ1-3ä¸ªå¼ºåŒ–å¼¹å¹•
        const count = Math.floor(Math.random() * 3) + 1;
        for (let i = 0; i < count; i++) {
          setTimeout(() => createDanmaku(true), i * 100);
        }
      }
      
      requestAnimationFrame(checkBeatAndCreateDanmaku);
    }
    
    // è‡ªåŠ¨ç”Ÿæˆæ™®é€šå¼¹å¹•
    let autoDanmakuInterval;
    function startAutoDanmaku() {
      autoDanmakuInterval = setInterval(() => {
        if (isPlaying) createDanmaku();
      }, 200); // æ™®é€šå¼¹å¹•ç”Ÿæˆé—´éš”
    }
    
    // äº‹ä»¶ç›‘å¬
    document.getElementById('startBtn').addEventListener('click', () => {
      const btn = document.getElementById('startBtn');
      if (!isPlaying) {
        // å¼€å§‹æ’­æ”¾
        if (!audioContext) initAudio();
        document.getElementById('bgMusic').play();
        isPlaying = true;
        btn.innerHTML = '<i class="fa fa-pause mr-2"></i> æš‚åœ';
        btn.classList.remove('bg-primary');
        btn.classList.add('bg-flash');
        checkBeatAndCreateDanmaku();
        startAutoDanmaku();
      } else {
        // æš‚åœæ’­æ”¾
        document.getElementById('bgMusic').pause();
        isPlaying = false;
        btn.innerHTML = '<i class="fa fa-play mr-2"></i> ç»§ç»­';
        btn.classList.remove('bg-flash');
        btn.classList.add('bg-primary');
        clearInterval(autoDanmakuInterval);
      }
    });
    
    // ç‹‚è½°æ»¥ç‚¸æŒ‰é’® (ä¸€æ¬¡ç”Ÿæˆå¤šä¸ªå¼¹å¹•)
    document.getElementById('addDanmaku').addEventListener('click', () => {
      const count = Math.floor(Math.random() * 10) + 8; // 8-17ä¸ªå¼¹å¹•
      for (let i = 0; i < count; i++) {
        setTimeout(() => createDanmaku(Math.random() > 0.3), i * 50);
      }
    });
    
    // æ¸…ç©ºå¼¹å¹•
    document.getElementById('clearDanmaku').addEventListener('click', () => {
      document.querySelectorAll('.danmaku').forEach(d => d.remove());
    });
  </script>
</body>
</html>